# Chapter 3 Function

## 생각해보기

### 기본단위(Unit)?
- 더 이상 쪼개지지 않는 (atomic)
- 행위를 하는 단위
- 일련의 행위의 단위

### 추상화란?
- 두둥등장하는 생각
- 공통의 특성을 뽑아내는(Abstract) 행위
- 두루뭉실하게 기능을 막연하게 그리는 것

### 함수란 무엇인가?
- 프로그램을 움직이는 기본단위
- f(x) = 2x
- 하나의 기능 단위

### 함수를 잘 만드는 법이란?
- 존나 짧게 짜면된다
- 분리를 잘한다
- 이름을 잘지어야합니다

### 읽기 쉽고 이해하기 쉬운 함수란?
- 마음이 맞는 사람이 짠 코드
- 함수 내에서 의도를 명확히 드러내는 변수명과 로직들
- 함수명만 봤을 때 어떤 동작을 하는지 인식하기 쉽고 잘 분리된 함수

### 의도를 분명히 표현하는 함수란?
- 내가 짠 함수
- 짧게 짤 수록 의도가 분명히 보인다
- 변수명 잘 지어라

### 직관적으로 파악하는 함수란?
- 함수명이 명확하며 하나의 기능만 수행하는 함수
- 봤을 때 기분 좋은 함수
- 함수명이 중요하죠

### 어떻게 코드를 작성하는가?
- 일단 돌아가게 짜 그 다음 리팩토링해 최고의 리팩토링은 뭐다 다시 짜는거다
- 도메인 이름을 활요하여 작성
- 최대한 제 3자가 보는 입장에서 이해하기 쉬운 코드를 짜려고 한다.

### 함수를 어떻게 만드는가?
- 내가 필요한 순간 찾게 되어 만든다
- 기능에 생명을 불어넣듯이 코드를 불어 넣는다
- 중복되는 기능이 존재하면 함수 뽑아내고, 하나의 기능을 수행하는 단위로 함수를 만듭니다

### 함수를 어떻게 유추하는가?
- 다른 함수를 어떻게 만들었는지를 보고 유추합니다
- 함수명과 매개변수를 보고 유추합니다
- 함수명과 인수

[추상화(Abstraction)](https://ko.dict.naver.com/#/userEntry/koko/0f989d729a86c9f537eacfb56848fb6d)
```
	주어진 문제나 시스템을 중요하고 관계 있는 부분만 분리해 내어 간결하고 이해하기 쉽게 만드는 작업.
    이러한 과정은 원래의 문제에서 구체적인 사항은 되도록 생략하고 핵심이 되는 원리만을 따지기 때문에 원래의 문제와는 전혀 관계가 없어 보이는 수학적인 모델이 나오기도 한다.
    이 기법은 복잡한 문제나 시스템을 이해하거나 설계하는 데 없어서는 안될 중요한 요소이다.
```

## 작게 만들기

- 짧을 수록 잘 읽힌다

```tsx
const isBoolean = (item: boolean): boolean => typeof item === 'boolean'

function isBoolean2 (item: boolean): boolean {
	return typeof item === 'boolean' 
}
```

## 블록과 들여쓰기

- if 문 / else 문 / while 문에 들어가는 블록은 한 줄
- 들여쓰기는 1~2 단 내에서 처리

## 한 가지만 해라

- 지정된 함수 이름 아래에서 추상화 수준이 하나인 단계만 수행한다면 그 함수는 한가지 작업만 한다
- 의미 있는 이름으로 다른 함수를 추출하는게 가능한가?
    - 한 가지 이상의 일을 처리 중...

## 함수 당 추상화 수준은 하나로

- 근본 개념과 세부사항의 구분이 어려워 읽는 사람이 어렵다
- 섞일경우,  깨진 창문처럼 세부사항을 추가해 간다

## 위에서 아래로 코드 읽기: 내려가기 규칙

- 함수의 추상화 수준이 낮아지는 현상
- 추상화 수준이 하나인 함수 === 한 가지만 하는 함수

## switch문

- 본질적으로 N가지의 분기를 처리한다
- 다형성(Polymorphism)을 이용한 추상화

### 목록 3-4의 한계

- 함수가 길어진다
- 한 가지 작업만 수행하지 못 한다
- SRP(Single Responsibility Responsible)을 위반한다
- OCP(Open Closed Principle)을 위반한다
- 동일한 함수의 반복

### 해결법

- abstract factory를 이용한 상속 관계로 표현

## 서술적인 이름을 사용하라

```latex
코드를 읽으면서 짐작했던 기능을 각 루틴이 그대로 수행한다면 깨끗한 코드라 불러도 되겠다. 
코드가 그 문제를 풀기 위한 언어처럼 보인다면 아름다운 코드라 불러도 되겠다.

by Ward Cunningham
```

- 함수가 하는 일에 대해 잘 표현하기 위함이다
- 길이는 상관없다
- 시간을 들여도 좋다
- IDE 지원
- 결국, 일관성

## 함수 인수

- 이상적인 인수는 0개
- 인수와 함수 간에 같은 추상화 수준이 적용되어야 한다
- 출력 인수
    - 복잡도 증가

### 많이 쓰는 단항 형식

- 인수에 질문을 하는 경우
- 이벤트
    - 이벤트라는 사실이 드러나도록 이름과 문맥을 선택
- 출력 인수 대신 반환 값 제공

### 플래그 인수

- 추한 flag 인수
- 함수가 여러가지를 처리한다는 것을 공표하는 셈이다

### 이항 함수

- 무시되는 인수에 대한 인지의 과정도 시간이 든다
    - 무시한 코드에 오류가 나타난다
- 자연적인 순서가 있으면 상관없다

### 삼항 함수

- 순서 / 주춤 /  무시 의 3단 콤보
- 과연 부동소수점을 비교하는데는 적절한가?

### 인수 객체

- 개념을 표현하며 인수를 줄이는 방법

### 인수 목록

- 가변 인수는 결국, List 형 인수 하나

### 동사와 키워드

- naming은 함수의 의도나 인수의 순서와 의도를 제대로 표현하기 위한 필수 조건

## 부수 효과를 일으키지 마라

- 시간적인 결합(temporal coupling) / 순서 종속성(order dependency) 초래

### 출력 인수

- 함수 선언부를 찾아보는 행위 === 코드를 보다가 주춤하는 행위 (인지적 거슬림)
- this keyword를 사용하자

## 명령과 조회를 분리하라

- 결국, 함수는 한 가지 일만 하도록 만들자
- 초기화 / 수정 /  반환 / 출력 중 한가지만 하기

## 오류 코드보다 예외를 사용하라

- 명령 함수에서 오류 코드를 반환하는 방식은 명령/조회 분리 규칙을 위반한다
- try/catch를 이용한 예외를 사용하면 오류 처리 코드가 원래 코드에서 분리되어 깔끔해진다

### Try/Catch 블록 뽑아내기

- 추한 try/catch 블록
- 함수로 뽑아서 한꺼번에 처리

### 오류 처리도 한 가지 작업이다

- 오류를 처리하는 함수는 오류만 처리해야 한다
- try로 시작하여 catch/finally로 끝나야 한다

### [Error.java](http://error.java) 의존성 자석

- 기존 오류 코드의 재사용
- 오류 코드 대신 예외를 사용하면 Exception 클래스에서 파생
    - 재컴파일 / 재배치 없이도  새 예외 클래스 추가

## 반복하지 마라

- 악의 근원인 중복 코드
- 정규 형식
- AOP(Aspect Oriented Programming)
- COP(Component Oriented Programming)
- structural programming
- subroutine의 독립화?

## 구조적 프로그래밍

```latex
모든 함수와 함수 내 모든 블록의 입구(entry)와 출구(exit)가 하나만 존재해야 한다
- By Edsger Dijkstra
```

- break/continue와 다중 return 금지
    - 그러나, 함수가 작다면 단일 입/출구 규칙(single entry-exit rule)보다 의도를 표현하기 좋다
- goto 문은  큰 함수에서만 의미가 있으므로, 작은 함수에서는 피하자

## 함수를 어떻게 짜죠?

- like 글짓기, 스토리텔링
- 처음부터 완벽한 코드가 가능할까?

## 결론

- 모든 시스템은 특정 시스템을 기술할 목적으로 설계한 도메인 특화 언어(Domain Specific Language)로 만든다
- 프로그래밍 기술은 언어 설계의 기술이다
- 대가(master)는 시스템을 프로그램이 아니라 이야기(Story)로 본다
- 함수가 분명하고 정확한 언어로 깔끔하게 맞아 떨어져야 이야기를 풀어나가기 쉬워진다는 사실!!

# 결국...

### 합의가 이루어진 코드

### 의도가 드러나는 함수

### 이야기를 서술

### 중첩 구조를 피하라

### 추상화 수준이 명확한 함수

### 일정한 추상화 수준이 유지되는 코드

### 일관성 있는 코드

### 개선하기 쉬운 코드

### 함수의 정보는 쓰레기

### 동작의 분리에 따른 리팩토링

### 함수는 리팩토링

### 진정한 목표는 시스템이라는 이야기를 풀어나가는 것

